/*
 * fogLoader, an ajax modal loader supporting jQuery UI themes
 * by Corbin Camp - ccamp@onebox.com @corbincamp
 * Version 1.0.0
 * Created 2010
 * License: GPL
 * 
 */
(function($){var m=0;var n;$.fn.fogLoader=function(h){var i={message:'Loading',animated:false,closeOnEscape:true,height:25,maxHeight:false,maxWidth:false,minHeight:15,minWidth:20,position:'center',width:135,textAlign:'center',wrapText:'nowrap',fontSize:null,fontFamily:null,fontWeight:null,borderRadius:null,borderWidth:'1px',spell:false,style:'message',progressMax:10,activityChar:'.',progressDelay:250,progressValue:0,progressMessage:null};var j=null;var k=1;var l={close:function(){$('.ui-progressbar, .ui-progressbar-msg').remove();clearInterval(n);$(this).dialog('close')},destroy:function(){$('.ui-progressbar, .ui-progressbar-msg').remove();clearInterval(n);$(this).dialog('destroy')},progressValue:function(){return m},updateProgress:function(a){fillProgressBar(a)}};if(typeof h==='object'||!h){j=$.extend({},i,h)}else{if(l[h]){return l[h].apply(this,Array.prototype.slice.call(arguments,1))}else{$.error('_method '+h+' does not exist on jQuery.fogLoader')}};function fillProgressBar(a){m=a.val;if(a.msg){$('.ui-progressbar-msg').html(a.msg)}$('.ui-progressbar-value').css('width',m+'%').show()}$(this).each(function(){var c='#ui-dialog-title-'+$(this).attr('id');var d;if(j.style=='message'){if(j.animated){if(j.progressSpell){d=j.message.substring(0,1)}else{d=j.message}}else{d=j.message+'...'}}$(this).dialog({modal:true,resizable:false,closeText:'',draggable:false,closeOnEscape:j.closeOnEscape,height:j.height,width:j.width,maxHeight:j.maxHeight,minHeight:j.minHeight,maxWidth:j.maxWidth,minWidth:j.minWidth,position:j.position,title:d,beforeclose:function(a,b){$('#ui-dialog-title-loader-progressbar').remove();clearInterval(n);$(this).dialog('destroy')}});var e=$('.ui-dialog-titlebar');e.show().addClass('ui-state-default').removeClass('ui-widget-header').css({whiteSpace:j.wrapText,'border-width':'0px'});if(j.fontSize){ttl.css({fontSize:j.fontSize})}if(j.fontFamily){ttl.css({fontFamily:j.fontFamily})}if(j.fontWeight){e.css({fontWeight:j.fontWeight})}$('.ui-dialog-titlebar-close').remove();$('.ui-dialog').css({padding:'0',borderWidth:j.borderWidth});if(j.borderRadius){$('.ui-dialog, .ui-dialog-titlebar').css({'-moz-border-radius':j.borderRadius,'-webkit-border-radius':j.borderRadius})};if(j.style=='progressbar'){var f=$('<div>').attr('id',c+'-'+j.style).css('height',(j.height-5)+'px').progressbar({value:j.progressValue,max:j.progressMax})var g=$('.ui-progressbar-value');e.hide();$(this).css({height:'auto',padding:1,overflow:'hidden'})if(j.progressMessage){$(this).append($('<span>').addClass('ui-progressbar-msg').html(j.progressMessage).css({margin:'1px',fontSize:'.75em'}))}$(this).append(f);g.css('margin','-2px');if(!$.support.htmlSerialize){g.css('height',(j.height+5)+'px')}$('.ui-dialog .ui-widget-content').css('border-width','0px');if(j.progressValue!=false){fillProgressBar(j.progressValue)}}else{$(this).hide()}if(j.animated&&j.style!='progressbar'){j.progressMax=j.message.length+3;if(j.spell){$('.ui-dialog-title').html(j.message.substring(0,1))}n=setInterval(function(){var a=$('.ui-dialog-title').html();if(!a){clearInterval(n)}else{if(a.length<(j.message.length+(j.progressMax-j.message.length))){if(j.spell&&j.animated){if(k<j.message.length){a+=j.message.substring(k,k+1)}else{a+=j.activityChar}k++}else{a+=j.activityChar}}else{k=1;a=j.spell?j.message.substring(0,1):j.message}$('.ui-dialog-title').html(a)}},j.progressDelay)};$('.ui-widget-overlay').css('position','fixed')})}})(jQuery);